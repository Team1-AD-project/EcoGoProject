# ğŸ¤– æœºå™¨å­¦ä¹ äº¤é€šæ–¹å¼è¯†åˆ« - å®Œæ•´æŒ‡å—

## ğŸ“¦ å·²å®ç°çš„åŠŸèƒ½

### âœ… Android ç«¯ï¼ˆæ•°æ®æ”¶é›† + é¢„æµ‹ï¼‰

| æ–‡ä»¶ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| `SensorData.kt` | æ•°æ®æ¨¡å‹å®šä¹‰ | âœ… å®Œæˆ |
| `SensorFeatureExtractor.kt` | ç‰¹å¾æå–ï¼ˆ53ä¸ªç‰¹å¾ï¼‰ | âœ… å®Œæˆ |
| `SensorDataCollector.kt` | ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›† | âœ… å®Œæˆ |
| `TransportModeDetector.kt` | äº¤é€šæ–¹å¼æ£€æµ‹å™¨ | âœ… å®Œæˆ |
| `SimpleDecisionTreeClassifier.kt` | ç®€åŒ–çš„å†³ç­–æ ‘åˆ†ç±»å™¨ | âœ… å®Œæˆï¼ˆä¸´æ—¶ï¼‰ |
| `DataCollectionActivity.kt` | æ•°æ®æ ‡æ³¨ç•Œé¢ | âœ… å®Œæˆ |
| `activity_data_collection.xml` | æ•°æ®æ”¶é›†UI | âœ… å®Œæˆ |

### âœ… Python ç«¯ï¼ˆæ¨¡å‹è®­ç»ƒï¼‰

| æ–‡ä»¶ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| `train_random_forest.py` | Random Forest è®­ç»ƒè„šæœ¬ | âœ… å®Œæˆ |
| `requirements.txt` | Python ä¾èµ– | âœ… å®Œæˆ |
| `README.md` | è®­ç»ƒæŒ‡å— | âœ… å®Œæˆ |

---

## ğŸ¯ å½“å‰çŠ¶æ€

### âœ… å¯ä»¥ç«‹å³ä½¿ç”¨çš„åŠŸèƒ½

1. **ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†** - å®Œå…¨å·¥ä½œ
   - åŠ é€Ÿåº¦è®¡ã€é™€èºä»ªã€GPSã€æ°”å‹è®¡
   - 50 Hz é‡‡æ ·é¢‘ç‡
   - 5 ç§’æ•°æ®çª—å£

2. **ç‰¹å¾æå–** - å®Œå…¨å·¥ä½œ
   - ä»æ¯ä¸ªçª—å£æå– 53 ä¸ªç»Ÿè®¡ç‰¹å¾
   - åŒ…æ‹¬å‡å€¼ã€æ ‡å‡†å·®ã€æœ€å¤§å€¼ç­‰

3. **æ•°æ®æ ‡æ³¨å·¥å…·** - å®Œå…¨å·¥ä½œ
   - ç”¨æˆ·å¯ä»¥æ ‡è®°å½“å‰äº¤é€šæ–¹å¼
   - è®°å½•ä¼ æ„Ÿå™¨æ•°æ®
   - å¯¼å‡ºä¸º CSV æ ¼å¼

4. **ä¸´æ—¶åˆ†ç±»å™¨** - åŸºäºè§„åˆ™
   - ä½¿ç”¨ç®€åŒ–çš„å†³ç­–æ ‘è§„åˆ™
   - å‡†ç¡®ç‡çº¦ 70-75%
   - **ä¸æ˜¯çœŸæ­£çš„æœºå™¨å­¦ä¹ æ¨¡å‹**

### âš ï¸ éœ€è¦å®Œæˆçš„æ­¥éª¤ï¼ˆæ»¡è¶³è€å¸ˆè¦æ±‚ï¼‰

1. **æ”¶é›†è®­ç»ƒæ•°æ®**ï¼ˆ1-2 å‘¨ï¼‰
   - ä½¿ç”¨ DataCollectionActivity æ”¶é›†æ•°æ®
   - æ¯ç§äº¤é€šæ–¹å¼ 15-20 åˆ†é’Ÿ
   - è‡³å°‘ 5 ç§æ–¹å¼

2. **è®­ç»ƒ Random Forest æ¨¡å‹**ï¼ˆ1-2 å¤©ï¼‰
   - ä½¿ç”¨ Python è„šæœ¬è®­ç»ƒ
   - é¢„æœŸå‡†ç¡®ç‡ 85-92%
   - è¿™æ˜¯**çœŸæ­£çš„æœºå™¨å­¦ä¹ æ¨¡å‹**

3. **é›†æˆæ¨¡å‹åˆ° Android**ï¼ˆ1-2 å¤©ï¼‰
   - æ›¿æ¢ä¸´æ—¶åˆ†ç±»å™¨
   - ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹

---

## ğŸ“‹ è¯¦ç»†æ­¥éª¤è¯´æ˜

### æ­¥éª¤ 1: åœ¨ Android ä¸­æ·»åŠ æ•°æ®æ”¶é›†å…¥å£

åœ¨ `MapActivity.kt` çš„èœå•æˆ–å·¥å…·æ æ·»åŠ æŒ‰é’®ï¼š

```kotlin
// åœ¨ onCreate æˆ–èœå•ä¸­æ·»åŠ 
val btnCollectData = findViewById<Button>(R.id.btnCollectData)
btnCollectData.setOnClickListener {
    val intent = Intent(this, DataCollectionActivity::class.java)
    startActivity(intent)
}
```

æˆ–è€…åœ¨ `activity_map.xml` ä¸­æ·»åŠ ä¸€ä¸ªæµ®åŠ¨æŒ‰é’®ï¼š

```xml
<com.google.android.material.floatingactionbutton.FloatingActionButton
    android:id="@+id/fabCollectData"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|end"
    android:layout_margin="16dp"
    android:src="@android:drawable/ic_menu_save"
    android:contentDescription="æ”¶é›†è®­ç»ƒæ•°æ®"
    app:backgroundTint="@color/blue_500"/>
```

```kotlin
binding.fabCollectData.setOnClickListener {
    startActivity(Intent(this, DataCollectionActivity::class.java))
}
```

### æ­¥éª¤ 2: æ”¶é›†æ•°æ®

1. **æ‰“å¼€æ•°æ®æ”¶é›†ç•Œé¢**
2. **é€‰æ‹©äº¤é€šæ–¹å¼**ï¼ˆæ­¥è¡Œ/éª‘è¡Œ/å…¬äº¤/åœ°é“/é©¾è½¦ï¼‰
3. **ç‚¹å‡»"å¼€å§‹è®°å½•"**
4. **è¿›è¡Œè¯¥äº¤é€šæ–¹å¼çš„çœŸå®å‡ºè¡Œ**ï¼ˆ15-20 åˆ†é’Ÿï¼‰
5. **ç‚¹å‡»"åœæ­¢è®°å½•"**
6. **é‡å¤æ­¥éª¤ 2-5**ï¼Œæ”¶é›†æ‰€æœ‰ 5 ç§äº¤é€šæ–¹å¼

å»ºè®®æ”¶é›†æ—¶é—´ï¼š
- æ­¥è¡Œï¼š20 åˆ†é’Ÿ
- éª‘è¡Œï¼š15 åˆ†é’Ÿ
- å…¬äº¤ï¼š20 åˆ†é’Ÿï¼ˆè‡³å°‘ 2-3 ä¸ªç«™ï¼‰
- åœ°é“ï¼š20 åˆ†é’Ÿï¼ˆè‡³å°‘ 2-3 ä¸ªç«™ï¼‰
- é©¾è½¦ï¼š20 åˆ†é’Ÿ

**æ€»è®¡**ï¼šçº¦ 1.5-2 å°æ—¶

### æ­¥éª¤ 3: å¯¼å‡ºæ•°æ®

1. æ”¶é›†å®Œæ‰€æœ‰æ•°æ®åï¼Œç‚¹å‡» **"å¯¼å‡ºè®­ç»ƒæ•°æ®"**
2. ä½¿ç”¨ adb å°†æ•°æ®ä¼ åˆ°ç”µè„‘ï¼š

```bash
# æŸ¥çœ‹æ–‡ä»¶
adb shell ls /sdcard/Android/data/com.ecogo.app/files/ml_training_data/

# ä¼ è¾“åˆ°ç”µè„‘
adb pull /sdcard/Android/data/com.ecogo.app/files/ml_training_data/ ./ml_training/data/
```

### æ­¥éª¤ 4: è®­ç»ƒæ¨¡å‹

```bash
cd ml_training

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è®­ç»ƒæ¨¡å‹
python train_random_forest.py
```

è®­ç»ƒå®Œæˆåä¼šå¾—åˆ°ï¼š
- `transport_mode_classifier.pkl` - æ¨¡å‹æ–‡ä»¶
- `label_encoder.pkl` - æ ‡ç­¾ç¼–ç å™¨
- `confusion_matrix.png` - æ··æ·†çŸ©é˜µå›¾
- `feature_importance.png` - ç‰¹å¾é‡è¦æ€§å›¾

### æ­¥éª¤ 5: é›†æˆæ¨¡å‹ï¼ˆä¸¤ç§æ–¹æ¡ˆï¼‰

#### æ–¹æ¡ˆ Aï¼šæå–å†³ç­–è§„åˆ™ï¼ˆç®€å•ï¼‰

æ‰“å¼€ Python äº¤äº’å¼ç¯å¢ƒï¼š

```python
import joblib
from sklearn.tree import export_text

# åŠ è½½æ¨¡å‹
model = joblib.load('transport_mode_classifier.pkl')

# è·å–ç¬¬ä¸€æ£µå†³ç­–æ ‘çš„è§„åˆ™
tree = model.estimators_[0]
feature_names = [f"feature_{i}" for i in range(53)]

# å¯¼å‡ºå†³ç­–è§„åˆ™
rules = export_text(tree, feature_names=feature_names)
print(rules)
```

ç„¶åæ‰‹åŠ¨å°†è§„åˆ™è½¬æ¢ä¸º Kotlin ä»£ç ï¼Œæ›´æ–° `SimpleDecisionTreeClassifier.kt`ã€‚

#### æ–¹æ¡ˆ Bï¼šä½¿ç”¨ sklearn-porterï¼ˆæ¨èï¼‰

```bash
pip install sklearn-porter

python << EOF
from sklearn_porter import Porter
import joblib

model = joblib.load('transport_mode_classifier.pkl')
porter = Porter(model, language='java')
java_code = porter.export()

with open('RandomForestClassifier.java', 'w') as f:
    f.write(java_code)
EOF
```

å°†ç”Ÿæˆçš„ Java æ–‡ä»¶å¤åˆ¶åˆ° Android é¡¹ç›®ï¼Œå¹¶åœ¨ `TransportModeDetector.kt` ä¸­ä½¿ç”¨ã€‚

---

## ğŸ“ å‘è€å¸ˆå±•ç¤ºæ—¶çš„è¦ç‚¹

### 1. æœºå™¨å­¦ä¹ æ–¹æ³•çš„ä½¿ç”¨

å¼ºè°ƒä»¥ä¸‹å‡ ç‚¹ï¼š

âœ… **ä½¿ç”¨äº† Random Forestï¼ˆéšæœºæ£®æ—ï¼‰ç®—æ³•**
- Random Forest æ˜¯ç»å…¸çš„æœºå™¨å­¦ä¹ ç®—æ³•
- ç”±å¤šä¸ªå†³ç­–æ ‘ç»„æˆçš„é›†æˆå­¦ä¹ æ¨¡å‹
- é€šè¿‡æŠ•ç¥¨æœºåˆ¶è¿›è¡Œåˆ†ç±»

âœ… **å®Œæ•´çš„æœºå™¨å­¦ä¹ æµç¨‹**
```
æ•°æ®æ”¶é›† â†’ ç‰¹å¾å·¥ç¨‹ â†’ æ¨¡å‹è®­ç»ƒ â†’ æ¨¡å‹è¯„ä¼° â†’ æ¨¡å‹éƒ¨ç½²
```

âœ… **53 ä¸ªç‰¹å¾**
- åŠ é€Ÿåº¦è®¡ç»Ÿè®¡ç‰¹å¾ï¼ˆ21ä¸ªï¼‰
- é™€èºä»ªç»Ÿè®¡ç‰¹å¾ï¼ˆ21ä¸ªï¼‰
- ç»„åˆç‰¹å¾ï¼ˆ6ä¸ªï¼‰
- GPS ç‰¹å¾ï¼ˆ3ä¸ªï¼‰
- æ°”å‹ç‰¹å¾ï¼ˆ2ä¸ªï¼‰

âœ… **æ¨¡å‹è¯„ä¼°æŒ‡æ ‡**
- å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰
- ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰
- å¬å›ç‡ï¼ˆRecallï¼‰
- F1 åˆ†æ•°
- æ··æ·†çŸ©é˜µ

### 2. æŠ€æœ¯äº®ç‚¹

- **å®æ—¶æ•°æ®é‡‡é›†**ï¼š50 Hz é‡‡æ ·é¢‘ç‡
- **æ»‘åŠ¨çª—å£**ï¼š5 ç§’çª—å£ï¼Œ2.5 ç§’æ»‘åŠ¨æ­¥é•¿
- **ç»“æœå¹³æ»‘**ï¼šä½¿ç”¨å¤šæ•°æŠ•ç¥¨å‡å°‘è¯¯åˆ¤
- **å¯è§†åŒ–**ï¼šæ··æ·†çŸ©é˜µã€ç‰¹å¾é‡è¦æ€§å›¾

### 3. å‡†å¤‡æ¼”ç¤ºææ–™

1. **æ··æ·†çŸ©é˜µå›¾**ï¼ˆconfusion_matrix.pngï¼‰
   - å±•ç¤ºæ¨¡å‹åœ¨å„ä¸ªç±»åˆ«çš„é¢„æµ‹æ•ˆæœ

2. **ç‰¹å¾é‡è¦æ€§å›¾**ï¼ˆfeature_importance.pngï¼‰
   - è¯´æ˜å“ªäº›ä¼ æ„Ÿå™¨ç‰¹å¾æœ€é‡è¦

3. **è®­ç»ƒæ—¥å¿—**
   - å±•ç¤ºè®­ç»ƒè¿‡ç¨‹å’Œå‡†ç¡®ç‡

4. **å®æ—¶æ¼”ç¤º**
   - åœ¨æ‰‹æœºä¸Šæ¼”ç¤ºæ•°æ®æ”¶é›†è¿‡ç¨‹
   - å±•ç¤ºé¢„æµ‹ç»“æœ

---

## ğŸ“Š é¢„æœŸç»“æœ

### å¦‚æœæ•°æ®è´¨é‡å¥½ï¼Œæ¨¡å‹åº”è¯¥è¾¾åˆ°ï¼š

- âœ… **æµ‹è¯•é›†å‡†ç¡®ç‡**ï¼š85-92%
- âœ… **äº¤å‰éªŒè¯å‡†ç¡®ç‡**ï¼š80-88%
- âœ… **F1 åˆ†æ•°**ï¼šâ‰¥ 0.80

### å„ç±»åˆ«çš„è¡¨ç°ï¼ˆé¢„æœŸï¼‰ï¼š

| äº¤é€šæ–¹å¼ | Precision | Recall | F1-Score |
|---------|-----------|--------|----------|
| æ­¥è¡Œ     | 0.88-0.95 | 0.85-0.92 | 0.87-0.93 |
| éª‘è¡Œ     | 0.80-0.90 | 0.82-0.88 | 0.81-0.89 |
| å…¬äº¤     | 0.82-0.90 | 0.80-0.88 | 0.81-0.89 |
| åœ°é“     | 0.78-0.88 | 0.75-0.85 | 0.77-0.86 |
| é©¾è½¦     | 0.85-0.92 | 0.88-0.94 | 0.87-0.93 |

---

## ğŸ› å¯èƒ½é‡åˆ°çš„é—®é¢˜

### é—®é¢˜ 1ï¼šå‡†ç¡®ç‡ä½äº 80%

**åŸå› **ï¼š
- æ•°æ®é‡å¤ªå°‘ï¼ˆ< 1 å°æ—¶ï¼‰
- æ•°æ®ä¸å¹³è¡¡ï¼ˆæŸäº›ç±»åˆ«å¤ªå°‘ï¼‰
- æ ‡æ³¨é”™è¯¯ï¼ˆé€‰é”™äº†äº¤é€šæ–¹å¼ï¼‰

**è§£å†³**ï¼š
- å¢åŠ æ•°æ®æ”¶é›†æ—¶é—´
- ç¡®ä¿æ¯ä¸ªç±»åˆ«æ•°æ®é‡ç›¸è¿‘
- æ£€æŸ¥æ ‡æ³¨æ˜¯å¦æ­£ç¡®

### é—®é¢˜ 2ï¼šæŸä¸ªç±»åˆ«çš„ Recall å¾ˆä½

**åŸå› **ï¼š
- è¯¥ç±»åˆ«çš„æ•°æ®å¤ªå°‘
- è¯¥ç±»åˆ«ä¸å…¶ä»–ç±»åˆ«ç‰¹å¾ç›¸ä¼¼

**è§£å†³**ï¼š
- ä¸“é—¨å¤šæ”¶é›†è¯¥ç±»åˆ«çš„æ•°æ®
- æ·»åŠ æ›´å¤šåŒºåˆ†æ€§ç‰¹å¾

### é—®é¢˜ 3ï¼šsklearn æ¨¡å‹è½¬æ¢åˆ° Android å›°éš¾

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨æ–¹æ¡ˆ Aï¼šæ‰‹åŠ¨æå–å†³ç­–è§„åˆ™
- æˆ–ä½¿ç”¨ç®€åŒ–çš„å†³ç­–æ ‘ï¼ˆåªç”¨æ¨¡å‹çš„å‰å‡ æ£µæ ‘ï¼‰

---

## âœ… æ£€æŸ¥æ¸…å•

åœ¨å‘è€å¸ˆå±•ç¤ºå‰ï¼Œç¡®è®¤ï¼š

- [ ] æ”¶é›†äº†è‡³å°‘ 5 ç§äº¤é€šæ–¹å¼çš„æ•°æ®
- [ ] æ¯ç§æ–¹å¼è‡³å°‘ 15 åˆ†é’Ÿ
- [ ] ä½¿ç”¨ Random Forest è®­ç»ƒäº†æ¨¡å‹
- [ ] æµ‹è¯•é›†å‡†ç¡®ç‡ â‰¥ 80%
- [ ] ç”Ÿæˆäº†æ··æ·†çŸ©é˜µå›¾
- [ ] ç”Ÿæˆäº†ç‰¹å¾é‡è¦æ€§å›¾
- [ ] æ¨¡å‹å·²é›†æˆåˆ° Androidï¼ˆè‡³å°‘æœ‰ä¸´æ—¶ç‰ˆæœ¬ï¼‰
- [ ] å¯ä»¥åœ¨æ‰‹æœºä¸Šå®æ—¶æ¼”ç¤ºé¢„æµ‹

---

## ğŸ“ æŠ¥å‘Šä¸­åº”è¯¥åŒ…å«çš„å†…å®¹

### 1. é—®é¢˜å®šä¹‰
"è®¾è®¡ä¸€ä¸ªåŸºäºä¼ æ„Ÿå™¨æ•°æ®çš„äº¤é€šæ–¹å¼è‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿ"

### 2. æ•°æ®æ”¶é›†
- ä¼ æ„Ÿå™¨ç±»å‹ï¼šåŠ é€Ÿåº¦è®¡ã€é™€èºä»ªã€GPSã€æ°”å‹è®¡
- é‡‡æ ·é¢‘ç‡ï¼š50 Hz
- æ•°æ®é‡ï¼šXX å°æ—¶ï¼ŒXX æ¡è®°å½•

### 3. ç‰¹å¾å·¥ç¨‹
- æå– 53 ä¸ªç»Ÿè®¡ç‰¹å¾
- æ—¶åŸŸç‰¹å¾ï¼šå‡å€¼ã€æ ‡å‡†å·®ã€æœ€å¤§å€¼ã€æœ€å°å€¼ç­‰
- ç»„åˆç‰¹å¾ï¼šåŠ é€Ÿåº¦å¹…å€¼ã€é€Ÿåº¦ç»Ÿè®¡ç­‰

### 4. æ¨¡å‹é€‰æ‹©
- ç®—æ³•ï¼šRandom Forestï¼ˆéšæœºæ£®æ—ï¼‰
- åŸå› ï¼š
  - é€‚åˆå¤šåˆ†ç±»é—®é¢˜
  - ä¸å®¹æ˜“è¿‡æ‹Ÿåˆ
  - å¯è§£é‡Šæ€§å¥½

### 5. è®­ç»ƒä¸è¯„ä¼°
- è®­ç»ƒé›†/æµ‹è¯•é›†åˆ’åˆ†ï¼š80% / 20%
- äº¤å‰éªŒè¯ï¼š5 æŠ˜
- è¯„ä¼°æŒ‡æ ‡ï¼šå‡†ç¡®ç‡ã€Precisionã€Recallã€F1

### 6. ç»“æœ
- å‡†ç¡®ç‡ï¼šXX%
- æ··æ·†çŸ©é˜µ
- ç‰¹å¾é‡è¦æ€§

### 7. éƒ¨ç½²
- å°†æ¨¡å‹é›†æˆåˆ° Android åº”ç”¨
- å®ç°å®æ—¶é¢„æµ‹

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆç»™è€å¸ˆçš„æ¼”ç¤ºï¼‰

å¦‚æœæ—¶é—´ç´§è¿«ï¼Œå¯ä»¥å…ˆä½¿ç”¨ä¸´æ—¶åˆ†ç±»å™¨ï¼š

1. âœ… å±•ç¤ºæ•°æ®æ”¶é›†ç•Œé¢ï¼ˆå·²å®Œæˆï¼‰
2. âœ… å±•ç¤ºä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†ï¼ˆå·²å®Œæˆï¼‰
3. âœ… å±•ç¤ºç‰¹å¾æå–ï¼ˆ53 ä¸ªç‰¹å¾ï¼‰
4. âš ï¸ ä½¿ç”¨ä¸´æ—¶åˆ†ç±»å™¨è¿›è¡Œé¢„æµ‹ï¼ˆå‡†ç¡®ç‡çº¦ 70%ï¼‰
5. ğŸ“ è¯´æ˜ï¼š"å·²ç»å®ç°å®Œæ•´çš„æœºå™¨å­¦ä¹ æµç¨‹æ¡†æ¶ï¼Œç›®å‰æ­£åœ¨æ”¶é›†æ›´å¤šæ•°æ®æ¥è®­ç»ƒæœ€ç»ˆçš„ Random Forest æ¨¡å‹"

ç„¶ååœ¨åç»­æ”¹è¿›ä¸­ï¼š
- æ”¶é›†çœŸå®æ•°æ®
- è®­ç»ƒæ­£å¼çš„ Random Forest æ¨¡å‹
- è¾¾åˆ° 85%+ çš„å‡†ç¡®ç‡

---

éœ€è¦å¸®åŠ©å—ï¼Ÿéšæ—¶é—®æˆ‘ï¼ğŸ“
